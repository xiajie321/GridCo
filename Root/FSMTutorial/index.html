<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœ‰é™çŠ¶æ€æœº (FSM) è¯¦è§£ - äº’åŠ¨æ•™ç¨‹</title>
    <link rel="stylesheet" href="../../style.css">
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">
</head>
<body>
    <div class="container">
        <div style="margin-bottom: 10px;">
            <a href="../../index.html" class="pixel-btn">â† è¿”å›ç›®å½•</a>
        </div>

        <header class="pixel-box header">
            <h1>æœ‰é™çŠ¶æ€æœº (FSM)</h1>
            <p class="subtitle">æ¸¸æˆ AI çš„åŸºçŸ³ï¼šä»é©¬é‡Œå¥¥åˆ° Boss æˆ˜</p>
        </header>

        <!-- 1. æ¦‚å¿µå¼•å…¥ -->
        <div class="pixel-box tutorial-section">
            <div class="icon-header">
                <div class="pixel-icon fsm-icon"></div>
                <h2>1. ä»€ä¹ˆæ˜¯ FSMï¼Ÿ</h2>
            </div>
            <p>ä½ çš„è§’è‰²ä¸å¯èƒ½åŒæ—¶â€œè·³è·ƒâ€å’Œâ€œè¶´ä¸‹â€ã€‚çŠ¶æ€æœºå°±æ˜¯ç”¨æ¥ç®¡ç†è¿™äº›äº’æ–¥è¡Œä¸ºçš„å·¥å…·ã€‚</p>
            <p><strong>ä¸‰å¤§è¦ç´ ï¼š</strong></p>
            <ul style="list-style-type: square; padding-left: 20px;">
                <li><strong>çŠ¶æ€ (State)ï¼š</strong> è§’è‰²å½“å‰çš„æ¨¡å¼ï¼ˆå¦‚ Idle, Run, Jumpï¼‰ã€‚</li>
                <li><strong>è½¬æ¢ (Transition)ï¼š</strong> æ”¹å˜çŠ¶æ€çš„æ¡ä»¶ï¼ˆå¦‚ æŒ‰ä¸‹ç©ºæ ¼ -> åˆ‡æ¢åˆ° Jumpï¼‰ã€‚</li>
                <li><strong>åŠ¨ä½œ (Action)ï¼š</strong> çŠ¶æ€å†…æ‰§è¡Œçš„é€»è¾‘ï¼ˆå¦‚ æ’­æ”¾è·³è·ƒåŠ¨ç”»ï¼‰ã€‚</li>
            </ul>
        </div>

        <!-- 2. äº’åŠ¨æ¼”ç¤º -->
        <div class="pixel-box tutorial-section">
            <div class="icon-header">
                <div class="pixel-icon fsm-icon"></div>
                <h2>2. çŠ¶æ€æœºå®éªŒå®¤</h2>
            </div>
            <p>ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®è§¦å‘äº‹ä»¶ï¼Œè§‚å¯ŸçŠ¶æ€å¦‚ä½•æµè½¬ã€‚æ³¨æ„çœ‹å·¦ä¾§çš„çŠ¶æ€å›¾è¿çº¿åŠ¨ç”»ã€‚</p>
            
            <div class="demo-container">
                <div class="diagram-view">
                    <canvas id="fsm-canvas" width="600" height="400"></canvas>
                </div>
                <div class="char-view">
                    <div id="char-display" style="font-size: 3em; transition: transform 0.2s;">ğŸ˜</div>
                    <div id="char-status" style="margin-top: 10px; color: #FFF;">Idle</div>
                </div>
            </div>
            
            <div class="controls">
                <button class="pixel-btn" id="btn-move">ç§»åŠ¨ (Move)</button>
                <button class="pixel-btn" id="btn-jump">è·³è·ƒ (Jump)</button>
                <button class="pixel-btn" id="btn-attack">æ”»å‡» (Attack)</button>
                <button class="pixel-btn" id="btn-stop">åœæ­¢ (Stop)</button>
            </div>
        </div>

        <!-- 3. å®ç°æ–¹å¼è¯¦è§£ -->
        <div class="pixel-box tutorial-section">
            <div class="icon-header">
                <div class="pixel-icon fsm-icon"></div>
                <h2>3. ä¸¤ç§å®ç°æµæ´¾</h2>
            </div>
            
            <div class="compare-grid">
                <div class="compare-item">
                    <h4>æ–¹æ³•ä¸€ï¼šSwitch-Case</h4>
                    <p><strong>é€‚ç”¨ï¼š</strong> ç®€å•çš„å¯¹è±¡ï¼ˆå¦‚é—¨ã€é™·é˜±ã€ç®€å•å°æ€ªï¼‰ã€‚</p>
                    <p><strong>ä¼˜ç‚¹ï¼š</strong> å†™èµ·æ¥å¿«ï¼Œä¸€ä¸ªæ–‡ä»¶æå®šã€‚</p>
                    <p><strong>ç¼ºç‚¹ï¼š</strong> çŠ¶æ€å¤šäº†ä»£ç ä¼šå˜æˆå‡ åƒè¡Œçš„â€œå±å±±â€ã€‚</p>
                </div>
                <div class="compare-item">
                    <h4>æ–¹æ³•äºŒï¼šçŠ¶æ€æ¨¡å¼ (State Pattern)</h4>
                    <p><strong>é€‚ç”¨ï¼š</strong> å¤æ‚çš„è§’è‰²ï¼ˆç©å®¶ã€Bossï¼‰ã€‚</p>
                    <p><strong>ä¼˜ç‚¹ï¼š</strong> æ¯ä¸ªçŠ¶æ€ä¸€ä¸ªç±»ï¼Œé€»è¾‘åˆ†ç¦»ï¼Œæ˜“äºæ‰©å±•ã€‚</p>
                    <p><strong>ç¼ºç‚¹ï¼š</strong> ç±»æ–‡ä»¶å˜å¤šã€‚</p>
                </div>
            </div>
        </div>

        <!-- 4. ä»£ç å®æˆ˜ -->
        <div class="pixel-box tutorial-section">
            <div class="icon-header">
                <div class="pixel-icon fsm-icon"></div>
                <h2>4. C# ä»£ç å®æˆ˜ (State Pattern)</h2>
            </div>
            <p>è¿™æ˜¯æœ€ä¸“ä¸šçš„å†™æ³•ï¼Œè™½ç„¶çœ‹ç€ä»£ç å¤šï¼Œä½†ç»´æŠ¤æ€§æä½³ã€‚</p>

            <div class="code-step">
                <h3>1. å®šä¹‰æ¥å£</h3>
                <pre><code class="language-csharp">
public interface IState {
    void Enter();  // è¿›å…¥çŠ¶æ€æ—¶è°ƒç”¨ä¸€æ¬¡
    void Update(); // æ¯å¸§è°ƒç”¨
    void Exit();   // é€€å‡ºçŠ¶æ€æ—¶è°ƒç”¨ä¸€æ¬¡
}
                </code></pre>
            </div>

            <div class="code-step">
                <h3>2. çŠ¶æ€æœºæ§åˆ¶å™¨</h3>
                <pre><code class="language-csharp">
public class StateMachine {
    private IState currentState;

    public void ChangeState(IState newState) {
        if (currentState != null)
            currentState.Exit();

        currentState = newState;
        currentState.Enter();
    }

    public void Update() {
        if (currentState != null)
            currentState.Update();
    }
}
                </code></pre>
            </div>
            
            <div class="code-step">
                <h3>3. å…·ä½“çŠ¶æ€å®ç°</h3>
                <pre><code class="language-csharp">
public class JumpState : IState {
    Player player;
    public JumpState(Player p) { player = p; }

    public void Enter() {
        player.PlayAnimation("Jump");
        player.AddForce(Vector3.up * 5);
    }

    public void Update() {
        // è½¬æ¢æ¡ä»¶ï¼šè½åœ°äº†å°±åˆ‡å› Idle
        if (player.IsGrounded()) {
            player.stateMachine.ChangeState(new IdleState(player));
        }
    }

    public void Exit() { /* æ¸…ç†å·¥ä½œ */ }
}
                </code></pre>
            </div>
        </div>

        <footer class="pixel-box" style="text-align: center; margin-top: 20px;">
            <p>FSM æ˜¯æœ€åŸºç¡€çš„ï¼Œä½†å¦‚æœé€»è¾‘å¤ªå¤æ‚ï¼ˆæ¯”å¦‚å‡ åä¸ªçŠ¶æ€äº’è”ï¼‰ï¼Œè¯·è€ƒè™‘å‡çº§åˆ° <strong>è¡Œä¸ºæ ‘</strong>ã€‚</p>
        </footer>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script src="script.js"></script>
</body>
</html>
